(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{176:function(e,t){},178:function(e,t){},192:function(e,t){},194:function(e,t){},222:function(e,t){},224:function(e,t){},225:function(e,t){},230:function(e,t){},232:function(e,t){},251:function(e,t){},263:function(e,t){},266:function(e,t){},283:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a(48),s=a.n(c),o=a(12),r=a(6),l=a(51),i=a.n(l),b=function(e){if("undefined"!==window)return i.a.get(e)},j=function(e,t){var a,n;console.log("AUTHENTICATE HELPER ON SIGNIN RESPONSE",e),a="token",n=e.data.token,"undefined"!==window&&i.a.set(a,n,{expires:1}),function(e,t){"undefined"!==window&&localStorage.setItem(e,JSON.stringify(t))}("user",e.data.user),t()},d=function(){if("undefined"!==window&&b("token"))return!!localStorage.getItem("user")&&JSON.parse(localStorage.getItem("user"))},u=function(e){var t;t="token","undefined"!==window&&i.a.remove(t,{expires:1}),function(e){"undefined"!==window&&localStorage.removeItem(e)}("user"),e()},m=function(e,t){if(console.log("UPDATE USER IN LOCALSTORAGE HELPERS",e),"undefined"!==typeof window){var a=JSON.parse(localStorage.getItem("user"));a=e.data,localStorage.setItem("user",JSON.stringify(a))}t()},O=a(0),h=Object(r.g)((function(e){var t=e.children,a=e.match,c=e.history,s=function(e){return a.path===e?{color:"#000"}:{color:"#fff"}};return Object(O.jsxs)(n.Fragment,{children:[Object(O.jsxs)("ul",{className:"nav nav-tabs bg-primary",children:[Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)(o.b,{to:"/",className:"nav-link",style:s("/"),children:"Home"})}),!d()&&Object(O.jsxs)(n.Fragment,{children:[Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)(o.b,{to:"/signin",className:"nav-link",style:s("/signin"),children:"Signin"})}),Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)(o.b,{to:"/signup",className:"nav-link",style:s("/signup"),children:"Signup"})})]}),d()&&"admin"===d().role&&Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)(o.b,{className:"nav-link",style:s("/admin"),to:"/admin",children:d().name})}),d()&&"subscriber"===d().role&&Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)(o.b,{className:"nav-link",style:s("/private"),to:"/private",children:d().name})}),d()&&Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)("span",{className:"nav-link",style:{cursor:"pointer",color:"#fff"},onClick:function(){u((function(){c.push("/")}))},children:"Signout"})})]}),Object(O.jsx)("div",{className:"container",children:t})]})})),f=function(){return Object(O.jsx)(h,{children:Object(O.jsxs)("div",{className:"col-md-6 offset-md-3 text-center",children:[Object(O.jsx)("h1",{className:"p-5",children:"Ultimate Authentication"}),Object(O.jsx)("h2",{children:"MERN Stack"}),Object(O.jsx)("hr",{}),Object(O.jsx)("p",{className:"lead",children:"Learn MERN stack web development by building production ready login register system with account activation, forgot password, reset password, login with facebook, login with google as well as ACL by implementing private and protected routes for authenticated user and users with the role of admin."})]})})},p=a(19),x=a(2),g=a(11),N=a(8),v=a.n(N),S=a(5),w=(a(24),function(){var e=Object(n.useState)({name:"Abbas",email:"abbasghayth5@gmail.com",password:"sa123",buttonText:"Submit"}),t=Object(g.a)(e,2),a=t[0],c=t[1],s=a.name,l=a.email,i=a.password,b=a.buttonText,j=function(e){return function(t){c(Object(x.a)(Object(x.a)({},a),{},Object(p.a)({},e,t.target.value)))}},u=function(e){e.preventDefault(),c(Object(x.a)(Object(x.a)({},a),{},{buttonText:"Submitting"})),v()({method:"POST",url:"".concat("http://localhost:5000/api","/signup"),data:{name:s,email:l,password:i}}).then((function(e){console.log("SIGNUP SUCCESS",e),c(Object(x.a)(Object(x.a)({},a),{},{name:"",email:"",password:"",buttonText:"Submitted"})),S.b.success(e.data.message)})).catch((function(e){console.log("SIGNUP ERROR",e.response.data),c(Object(x.a)(Object(x.a)({},a),{},{buttonText:"Submit"})),S.b.error(e.response.data.error)}))};return Object(O.jsx)(h,{children:Object(O.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(O.jsx)(S.a,{}),d()?Object(O.jsx)(r.a,{to:"/"}):null,Object(O.jsx)("h1",{className:"p-5 text-center",children:"Signup"}),Object(O.jsxs)("form",{children:[Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Name"}),Object(O.jsx)("input",{onChange:j("name"),value:s,type:"text",className:"form-control"})]}),Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Email"}),Object(O.jsx)("input",{onChange:j("email"),value:l,type:"email",className:"form-control"})]}),Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Password"}),Object(O.jsx)("input",{onChange:j("password"),value:i,type:"password",className:"form-control"})]}),Object(O.jsx)("div",{children:Object(O.jsx)("button",{className:"btn btn-primary",onClick:u,children:b})})]}),Object(O.jsx)("br",{}),Object(O.jsx)(o.b,{to:"/auth/password/forgot",className:"btn btn-sm btn-outline-danger",children:"Forgot Password"})]})})}),T=a(145),E=a.n(T),R=function(e){var t=e.informParent,a=void 0===t?function(e){return e}:t,n=function(e){console.log(e.tokenId),v()({method:"POST",url:"".concat("http://localhost:5000/api","/google-login"),data:{idToken:e.tokenId}}).then((function(e){console.log("GOOGLE SIGNIN SUCCESS",e),a(e)})).catch((function(e){console.log("GOOGLE SIGNIN ERROR",e.response)}))};return Object(O.jsx)("div",{className:"row mb-3",children:Object(O.jsx)("div",{className:"d-grid",children:Object(O.jsx)(E.a,{clientId:"".concat("1061494828962-dg329k718d297stivl4r0rlb67jfk1ru.apps.googleusercontent.com"),onSuccess:n,onFailure:n,render:function(e){return Object(O.jsxs)("button",{onClick:e.onClick,disabled:e.disabled,className:"btn btn-large btn-danger btn-block",children:[Object(O.jsx)("i",{className:"fab fa-google pr-2"})," Login with Google"]})},cookiePolicy:"single_host_origin"})})})},P=a(146),k=a.n(P),y=function(e){var t=e.informParent,a=void 0===t?function(e){return e}:t;return Object(O.jsx)("div",{className:"row mb-3",children:Object(O.jsx)("div",{className:"d-grid",children:Object(O.jsx)(k.a,{appId:"".concat("399990514991854"),autoLoad:!1,callback:function(e){console.log(e),v()({method:"POST",url:"".concat("http://localhost:5000/api","/facebook-login"),data:{userID:e.userID,accessToken:e.accessToken}}).then((function(e){console.log("FACEBOOK SIGNIN SUCCESS",e),a(e)})).catch((function(e){console.log("FACEBOOK SIGNIN ERROR",e.response)}))},render:function(e){return Object(O.jsxs)("button",{onClick:e.onClick,className:"btn btn-large btn-primary btn-block",children:[Object(O.jsx)("i",{className:"fab fa-facebook pr-2"})," Login with Facebook"]})}})})})},I=function(e){var t=e.history,a=Object(n.useState)({email:"abbasghayth5@gmail.com",password:"sa12345",buttonText:"Submit"}),c=Object(g.a)(a,2),s=c[0],l=c[1],i=s.email,b=s.password,u=s.buttonText,m=function(e){return function(t){l(Object(x.a)(Object(x.a)({},s),{},Object(p.a)({},e,t.target.value)))}},f=function(e){j(e,(function(){d()&&"admin"===d().role?t.push("/admin"):t.push("/private")}))},N=function(e){e.preventDefault(),l(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Submitting"})),v()({method:"POST",url:"".concat("http://localhost:5000/api","/signin"),data:{email:i,password:b}}).then((function(e){console.log("SIGNIN SUCCESS",e),j(e,(function(){l(Object(x.a)(Object(x.a)({},s),{},{name:"",email:"",password:"",buttonText:"Submitted"})),d()&&"admin"===d().role?t.push("/admin"):t.push("/private")}))})).catch((function(e){console.log("SIGNIN ERROR",e.response.data),l(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Submit"})),S.b.error(e.response.data.error)}))};return Object(O.jsx)(h,{children:Object(O.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(O.jsx)(S.a,{}),d()?Object(O.jsx)(r.a,{to:"/"}):null,Object(O.jsx)("h1",{className:"p-5 text-center",children:"Signin"}),Object(O.jsx)(R,{informParent:f}),Object(O.jsx)(y,{informParent:f}),Object(O.jsxs)("form",{children:[Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Email"}),Object(O.jsx)("input",{onChange:m("email"),value:i,type:"email",className:"form-control"})]}),Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Password"}),Object(O.jsx)("input",{onChange:m("password"),value:b,type:"password",className:"form-control"})]}),Object(O.jsx)("div",{children:Object(O.jsx)("button",{className:"btn btn-primary",onClick:N,children:u})})]}),Object(O.jsx)("br",{}),Object(O.jsx)(o.b,{to:"/auth/password/forgot",className:"btn btn-sm btn-outline-danger",children:"Forgot Password"})]})})},C=a(49),A=a.n(C),U=function(e){var t=e.match,a=Object(n.useState)({name:"",token:"",show:!0}),c=Object(g.a)(a,2),s=c[0],o=c[1];Object(n.useEffect)((function(){var e=t.params.token,a=A.a.decode(e).name;e&&o(Object(x.a)(Object(x.a)({},s),{},{name:a,token:e}))}),[]);var r=s.name,l=s.token,i=function(e){e.preventDefault(),v()({method:"POST",url:"".concat("http://localhost:5000/api","/account-activation"),data:{token:l}}).then((function(e){console.log("ACCOUNT ACTIVATION",e),o(Object(x.a)(Object(x.a)({},s),{},{show:!1})),S.b.success(e.data.message)})).catch((function(e){console.log("ACCOUNT ACTIVATION ERROR",e.response.data.error),S.b.error(e.response.data.error)}))};return Object(O.jsx)(h,{children:Object(O.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(O.jsx)(S.a,{}),Object(O.jsxs)("div",{className:"text-center",children:[Object(O.jsxs)("h1",{className:"p-5",children:["Hey ",r,", Ready to activate your account"]}),Object(O.jsx)("button",{className:"btn btn-outline-primary",onClick:i,children:"Activate Account"})]})]})})},D=function(e){var t=e.history,a=Object(n.useState)({role:"",name:"",email:"",password:"",buttonText:"Submit"}),c=Object(g.a)(a,2),s=c[0],o=c[1],r=b("token");Object(n.useEffect)((function(){l()}),[]);var l=function(){v()({method:"GET",url:"".concat("http://localhost:5000/api","/user/").concat(d()._id),headers:{Authorization:"Bearer ".concat(r)}}).then((function(e){console.log("PRIVATE PROFILE UPDATE",e);var t=e.data,a=t.role,n=t.name,c=t.email;o(Object(x.a)(Object(x.a)({},s),{},{role:a,name:n,email:c}))})).catch((function(e){console.log("PRIVATE PROFILE UPDATE ERROR",e.response.data.error),401===e.response.status&&u((function(){t.push("/")}))}))},i=s.role,j=s.name,f=s.email,N=s.password,w=s.buttonText,T=function(e){return function(t){o(Object(x.a)(Object(x.a)({},s),{},Object(p.a)({},e,t.target.value)))}},E=function(e){e.preventDefault(),o(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Submitting"})),v()({method:"PUT",url:"".concat("http://localhost:5000/api","/user/update"),headers:{Authorization:"Bearer ".concat(r)},data:{name:j,password:N}}).then((function(e){console.log("PRIVATE PROFILE UPDATE SUCCESS",e),m(e,(function(){o(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Submitted"})),S.b.success("Profile updated successfully")}))})).catch((function(e){console.log("PRIVATE PROFILE UPDATE ERROR",e.response.data.error),o(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Submit"})),S.b.error(e.response.data.error)}))};return Object(O.jsx)(h,{children:Object(O.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(O.jsx)(S.a,{}),Object(O.jsx)("h1",{className:"pt-4 text-center",children:"Private"}),Object(O.jsx)("p",{className:"lead text-center",children:"Profile update"}),Object(O.jsxs)("form",{children:[Object(O.jsxs)("div",{className:"mb-3 form-group",children:[Object(O.jsx)("label",{className:"form-label",children:"Role"}),Object(O.jsx)("input",{defaultValue:i,type:"text",className:"form-control",disabled:!0})]}),Object(O.jsxs)("div",{className:"mb-3 form-group",children:[Object(O.jsx)("label",{className:"form-label",children:"Name"}),Object(O.jsx)("input",{onChange:T("name"),value:j,type:"text",className:"form-control"})]}),Object(O.jsxs)("div",{className:"mb-3 form-group",children:[Object(O.jsx)("label",{className:"form-label",children:"Email"}),Object(O.jsx)("input",{defaultValue:f,type:"email",className:"form-control",disabled:!0})]}),Object(O.jsxs)("div",{className:"mb-3 form-group",children:[Object(O.jsx)("label",{className:"form-label",children:"Password"}),Object(O.jsx)("input",{onChange:T("password"),value:N,type:"password",className:"form-control"})]}),Object(O.jsx)("div",{children:Object(O.jsx)("button",{className:"btn btn-primary",onClick:E,children:w})})]})]})})},L=function(e){var t=e.history,a=Object(n.useState)({role:"",name:"",email:"",password:"",buttonText:"Submit"}),c=Object(g.a)(a,2),s=c[0],o=c[1],r=b("token");Object(n.useEffect)((function(){l()}),[]);var l=function(){v()({method:"GET",url:"".concat("http://localhost:5000/api","/user/").concat(d()._id),headers:{Authorization:"Bearer ".concat(r)}}).then((function(e){console.log("PRIVATE PROFILE UPDATE",e);var t=e.data,a=t.role,n=t.name,c=t.email;o(Object(x.a)(Object(x.a)({},s),{},{role:a,name:n,email:c}))})).catch((function(e){console.log("PRIVATE PROFILE UPDATE ERROR",e.response.data.error),401===e.response.status&&u((function(){t.push("/")}))}))},i=s.role,j=s.name,f=s.email,N=s.password,w=s.buttonText,T=function(e){return function(t){o(Object(x.a)(Object(x.a)({},s),{},Object(p.a)({},e,t.target.value)))}},E=function(e){e.preventDefault(),o(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Submitting"})),v()({method:"PUT",url:"".concat("http://localhost:5000/api","/admin/update"),headers:{Authorization:"Bearer ".concat(r)},data:{name:j,password:N}}).then((function(e){console.log("PRIVATE PROFILE UPDATE SUCCESS",e),m(e,(function(){o(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Submitted"})),S.b.success("Profile updated successfully")}))})).catch((function(e){console.log("PRIVATE PROFILE UPDATE ERROR",e.response.data.error),o(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Submit"})),S.b.error(e.response.data.error)}))};return Object(O.jsx)(h,{children:Object(O.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(O.jsx)(S.a,{}),Object(O.jsx)("h1",{className:"pt-4 text-center",children:"Admin"}),Object(O.jsx)("p",{className:"lead text-center",children:"Profile update"}),Object(O.jsxs)("form",{children:[Object(O.jsxs)("div",{className:"mb-3 form-group",children:[Object(O.jsx)("label",{className:"form-label",children:"Role"}),Object(O.jsx)("input",{defaultValue:i,type:"text",className:"form-control",disabled:!0})]}),Object(O.jsxs)("div",{className:"mb-3 form-group",children:[Object(O.jsx)("label",{className:"form-label",children:"Name"}),Object(O.jsx)("input",{onChange:T("name"),value:j,type:"text",className:"form-control"})]}),Object(O.jsxs)("div",{className:"mb-3 form-group",children:[Object(O.jsx)("label",{className:"form-label",children:"Email"}),Object(O.jsx)("input",{defaultValue:f,type:"email",className:"form-control",disabled:!0})]}),Object(O.jsxs)("div",{className:"mb-3 form-group",children:[Object(O.jsx)("label",{className:"form-label",children:"Password"}),Object(O.jsx)("input",{onChange:T("password"),value:N,type:"password",className:"form-control"})]}),Object(O.jsx)("div",{children:Object(O.jsx)("button",{className:"btn btn-primary",onClick:E,children:w})})]})]})})},F=a(50),G=["component"],V=function(e){var t=e.component,a=Object(F.a)(e,G);return Object(O.jsx)(r.b,Object(x.a)(Object(x.a)({},a),{},{render:function(e){return d()?Object(O.jsx)(t,Object(x.a)({},e)):Object(O.jsx)(r.a,{to:{pathname:"/signin",state:{from:e.location}}})}}))},B=["component"],H=function(e){var t=e.component,a=Object(F.a)(e,B);return Object(O.jsx)(r.b,Object(x.a)(Object(x.a)({},a),{},{render:function(e){return d()&&"admin"===d().role?Object(O.jsx)(t,Object(x.a)({},e)):Object(O.jsx)(r.a,{to:{pathname:"/signin",state:{from:e.location}}})}}))},J=function(e){e.history;var t=Object(n.useState)({email:"",buttonText:"Request password reset link"}),a=Object(g.a)(t,2),c=a[0],s=a[1],o=c.email,r=c.buttonText,l=function(e){e.preventDefault(),s(Object(x.a)(Object(x.a)({},c),{},{buttonText:"Submitting"})),v()({method:"PUT",url:"".concat("http://localhost:5000/api","/forgot-password"),data:{email:o}}).then((function(e){console.log("FORGOT PASSWORD SUCCESS",e),S.b.success(e.data.message),s(Object(x.a)(Object(x.a)({},c),{},{buttonText:"Requested"}))})).catch((function(e){console.log("FORGOT PASSWORD ERROR",e.response.data),S.b.error(e.response.data.error),s(Object(x.a)(Object(x.a)({},c),{},{buttonText:"Request password reset link"}))}))};return Object(O.jsx)(h,{children:Object(O.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(O.jsx)(S.a,{}),Object(O.jsx)("h1",{className:"p-5 text-center",children:"Forgot password"}),function(){return Object(O.jsxs)("form",{children:[Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Email"}),Object(O.jsx)("input",{onChange:(e="email",function(t){s(Object(x.a)(Object(x.a)({},c),{},Object(p.a)({},e,t.target.value)))}),value:o,type:"email",className:"form-control"})]}),Object(O.jsx)("div",{children:Object(O.jsx)("button",{className:"btn btn-primary",onClick:l,children:r})})]});var e}()]})})},q=function(e){var t=e.match,a=Object(n.useState)({name:"",token:"",newPassword:"",buttonText:"Reset password"}),c=Object(g.a)(a,2),s=c[0],o=c[1];Object(n.useEffect)((function(){var e=t.params.token,a=A.a.decode(e).name;e&&o(Object(x.a)(Object(x.a)({},s),{},{name:a,token:e}))}),[]);var r=s.name,l=s.token,i=s.newPassword,b=s.buttonText,j=function(e){o(Object(x.a)(Object(x.a)({},s),{},{newPassword:e.target.value}))},d=function(e){e.preventDefault(),o(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Submitting"})),v()({method:"PUT",url:"".concat("http://localhost:5000/api","/reset-password"),data:{newPassword:i,resetPasswordLink:l}}).then((function(e){console.log("RESET PASSWORD SUCCESS",e),S.b.success(e.data.message),o(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Done"}))})).catch((function(e){console.log("RESET PASSWORD ERROR",e.response.data),S.b.error(e.response.data.error),o(Object(x.a)(Object(x.a)({},s),{},{buttonText:"Reset password"}))}))};return Object(O.jsx)(h,{children:Object(O.jsxs)("div",{className:"col-md-6 offset-md-3",children:[Object(O.jsx)(S.a,{}),Object(O.jsxs)("h1",{className:"p-5 text-center",children:["Hey ",r,", Type your new password"]}),Object(O.jsxs)("form",{children:[Object(O.jsxs)("div",{className:"mb-3",children:[Object(O.jsx)("label",{className:"form-label",children:"Password"}),Object(O.jsx)("input",{onChange:j,value:i,type:"password",className:"form-control",placeholder:"Type new password",required:!0})]}),Object(O.jsx)("div",{children:Object(O.jsx)("button",{className:"btn btn-primary",onClick:d,children:b})})]})]})})},z=function(){return Object(O.jsx)(o.a,{children:Object(O.jsxs)(r.d,{children:[Object(O.jsx)(r.b,{path:"/",exact:!0,component:f}),Object(O.jsx)(r.b,{path:"/signup",exact:!0,component:w}),Object(O.jsx)(r.b,{path:"/signin",exact:!0,component:I}),Object(O.jsx)(r.b,{path:"/auth/activate/:token",exact:!0,component:U}),Object(O.jsx)(V,{path:"/private",exact:!0,component:D}),Object(O.jsx)(H,{path:"/admin",exact:!0,component:L}),Object(O.jsx)(r.b,{path:"/auth/password/forgot",exact:!0,component:J}),Object(O.jsx)(r.b,{path:"/auth/password/reset/:token",exact:!0,component:q})]})})};s.a.render(Object(O.jsx)(z,{}),document.getElementById("root"))}},[[283,1,2]]]);
//# sourceMappingURL=main.3d06b596.chunk.js.map